app-id: com.beakerbrowser.Beaker
runtime: org.freedesktop.Platform
runtime-version: '1.6'
branch: stable
sdk: org.freedesktop.Sdk
base: org.electronjs.Electron2.BaseApp
base-version: stable
command: beaker
separate-locales: false
finish-args:
- --share=ipc
- --share=network
- --device=dri
- --socket=x11
- --socket=wayland
- --socket=pulseaudio
- --filesystem=host
- --talk-name=org.freedesktop.Notifications
modules:
- name: beaker
  buildsystem: simple
  cleanup:
  - squashfs-root
  sources:
  - type: file
    only-arches:
    - x86_64
    url: https://github.com/beakerbrowser/beaker/releases/download/0.8.1/beaker-browser-0.8.1-x86_64.AppImage
    sha256: a70de60a6b53ab3d9ab954f42735320adc5648ac256906d446aca7c369556395
  - type: script
    dest-filename: beaker
    commands:
    - export PATH=$PATH:/var/run/host/usr/bin/
    - exec /app/beaker/beaker-browser
  - type: file
    path: com.beakerbrowser.Beaker.appdata.xml
  - type: file
    path: com.beakerbrowser.Beaker.desktop
  build-commands:
  - chmod +x beaker-browser-0.8.1-x86_64.AppImage
  - ./beaker-browser-0.8.1-x86_64.AppImage --appimage-extract

  - mkdir /app/beaker
  - cp -r squashfs-root/app/* /app/beaker/
  - install beaker /app/bin/

  - mkdir -p /app/share/icons/hicolor/512x512/apps/
  - cp squashfs-root/usr/share/icons/hicolor/512x512/apps/beaker-browser.png /app/share/icons/hicolor/512x512/apps/com.beakerbrowser.Beaker.png

  - mkdir -p /app/share/applications
  - cp com.beakerbrowser.Beaker.desktop /app/share/applications/com.beakerbrowser.Beaker.desktop

  - install -Dm644 com.beakerbrowser.Beaker.appdata.xml /app/share/metainfo/com.beakerbrowser.Beaker.appdata.xml
